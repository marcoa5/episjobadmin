<episjob-navbar [title]="'Reports'" [cerca]="false" [hide]="false"></episjob-navbar>


<div class="cont" (window:resize)="onResize()">
    
    <!--<episjob-h2 icon="file_download" [data]="'Export Report'" [padtop]="0"></episjob-h2>
    <button mat-raised-button color="primary" (click)="all()">Export All Rigs</button>
    <table id="ex">
        <tr>
            <th>Serial</th>
            <th>p/n</th>
            <th>Model</th>
            <th>Customer</th>
            <th>Site</th>
            <th>LastRead</th>
            <th>Eng</th>
            <th>Perc1</th>
            <th>Perc2</th>
            <th>Perc3</th>
        </tr>
        <tr *ngFor="let c of rigs">
            <td>{{c.sn}}</td>
            <td>{{c.in}}</td>
            <td>{{c.model}}</td>
            <td>{{c.customer}}</td>
            <td>{{c.site}}</td>
            <td>{{c.lastread}}</td>
            <td>{{c.orem}}</td>
            <td>{{c.perc1}}</td>
            <td>{{c.perc2}}</td>
            <td>{{c.perc3}}</td>
        </tr>
    </table>
    <div style="height:50px"></div>
    <mat-divider ></mat-divider>-->

    <div  *ngIf="pos=='SU' || pos=='admin'" >
        <episjob-h2 icon="file_download" [data]="'Certiq Report'" [padtop]="0"></episjob-h2>
        <div >
            <button class="but" mat-raised-button color="primary" (click)="certiq()">Download Report</button>
        </div>
        <div class="filC" *ngIf="info.length>1">
            <!--<button class="but" mat-raised-button color="primary" (click)="filt=!filt;filtra();" *ngIf="sortedData.length>0">{{filt?'Only SA':'Show all'}}</button>-->

            <mat-checkbox class="chb" (change)="filt=!filt;filtra();">{{width()?'Select only machines with SA' : 'Only SA'}}</mat-checkbox>            
            <mat-form-field class="but" >
                <mat-label>Filter data</mat-label>
                <input matInput autocomplete="off" [(ngModel)]="str" (input)="filtra()">
                <button mat-icon-button matSuffix (click)="str='';filtra()"><mat-icon>close</mat-icon></button>
            </mat-form-field>
        </div>
        <div class="contS" *ngIf="isThinking">
            <mat-spinner color="accent"></mat-spinner>
        </div>
        <div *ngIf="sortedData.length>0">
            <table matSort (matSortChange)="sortData($event)" class="contT">
                <thead>
                    <tr>
                        <th>Notes</th>
                        <th mat-sort-header="day">Hrs on<br>{{lastWorkingDay()}}</th>
                        <th mat-sort-header="."></th>
                        <th mat-sort-header="pred">Service Pred Date</th>
                        <th mat-sort-header="serial" >Serial Nr</th>
                        <th mat-sort-header="model">Model</th>
                        <th mat-sort-header="company">Company</th>
                        <th mat-sort-header="site">Site</th>
                        <th mat-sort-header="hrs">Engine Hrs</th>
                        <th mat-sort-header="step">Service Int</th>
                        <th mat-sort-header="next">Next Service in</th>
                    </tr>
                </thead>
              
                <tr *ngFor="let rig of sortedData" [ngClass]="{'mat-elevation-z8': width()}"[class.mat-elevation-z8]="true">
                    <td [ngStyle]="{'background-color':rig.machineNote==4?'indianred':rig.machineNote==3?'lightgreen':rig.machineNote==5?'gold':'white'}">
                        <select (change)="salva($event, rig.machineSerialNr)" [value]="rig.machineNote">
                            <option value=1>No SA</option>
                            <option value=2>SA</option>
                            <option value=3>PO/U</option>
                            <option value=4>PO/O</option>
                            <option value=5>Done</option>
                        </select>
                    </td>
                  <td>{{rig.LastDayEngineHours}}</td>
                  <td><div *ngIf="rig.hoursLeftToService>0" class="circ" [ngStyle]="{'background-color': rig.hoursLeftToService<=50? 'indianred' : rig.hoursLeftToService>50 && rig.hoursLeftToService<=100? 'gold':'lightgreen'}"></div></td>
                  <td>{{rig.servicePredictedDate|dateconv}}</td>

                  <td>{{rig.machineSerialNr}}</td>
                  <td>{{rig.machineModel}}</td>
                  <td>{{rig.machineCompany}}</td>
                  <td>{{rig.machineSite}}</td>
                  <td>{{rig.machineHrs}}</td>
                  <td>{{rig.serviceStep}}</td>
                  <td>{{rig.hoursLeftToService}}</td>
    
                </tr>
              </table>
        </div>
    </div>
</div> 