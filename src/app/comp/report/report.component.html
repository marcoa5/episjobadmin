<episjob-navbar [title]="'Reports'" [cerca]="false"></episjob-navbar>


<div class="cont" (window:resize)="onResize()">
    
    <episjob-h2 icon="file_download" [data]="'Export Report'" [padtop]="0"></episjob-h2>
    <button mat-raised-button color="primary" (click)="all()">Export All Rigs</button>
    <table id="ex">
        <tr>
            <th>Serial</th>
            <th>p/n</th>
            <th>Model</th>
            <th>Customer</th>
            <th>Site</th>
            <th>LastRead</th>
            <th>Eng</th>
            <th>Perc1</th>
            <th>Perc2</th>
            <th>Perc3</th>
        </tr>
        <tr *ngFor="let c of rigs">
            <td>{{c.sn}}</td>
            <td>{{c.in}}</td>
            <td>{{c.model}}</td>
            <td>{{c.customer}}</td>
            <td>{{c.site}}</td>
            <td>{{c.lastread}}</td>
            <td>{{c.orem}}</td>
            <td>{{c.perc1}}</td>
            <td>{{c.perc2}}</td>
            <td>{{c.perc3}}</td>
        </tr>
    </table>
    <div style="height:50px"></div>
    <mat-divider ></mat-divider>

    <div  *ngIf="!isMobile">
        <episjob-h2 icon="file_download" [data]="'Certiq Report'" [padtop]="0"></episjob-h2>
        <button mat-raised-button color="primary" (click)="certiq()">Certiq Report</button>
        <button mat-raised-button color="primary" (click)="tableCopy()" *ngIf="machineData.length>0" style="margin-left: 15px;">Copy to Cliboard</button>
        <div class="contS" *ngIf="isThinking">
            <mat-spinner color="accent"></mat-spinner>
        </div>
        <div *ngIf="machineData.length>0">
            <table #contT cellspacing="5px" mat-table [dataSource]="machineData" class="mat-elevation-z8 contT">
            <!-- Position Column -->
            <ng-container matColumnDef="Serial Number">
                <th mat-header-cell *matHeaderCellDef class="alCenter">Serial Number</th>
                <td mat-cell *matCellDef="let rig" class="alCenter w85"> {{rig.machineSerialNr}} </td>
            </ng-container>
            <ng-container matColumnDef="Item Number" >
                <th mat-header-cell *matHeaderCellDef class="alCenter">Item Number</th>
                <td mat-cell *matCellDef="let rig" class="alCenter w85" > {{rig.machineItemNumber}} </td>
            </ng-container>

            <ng-container matColumnDef="Model">
                <th mat-header-cell *matHeaderCellDef>Model</th>
                <td mat-cell *matCellDef="let rig" class=" alCenter w14" > {{rig.machineModel}} </td>
            </ng-container>
            <ng-container matColumnDef="Company" >
                <th mat-header-cell *matHeaderCellDef>Company</th>
                <td mat-cell *matCellDef="let rig" class="alCenter w20" > {{rig.machineCompany}} </td>
            </ng-container>
            <ng-container matColumnDef="Site" >
                <th mat-header-cell *matHeaderCellDef>Site</th>
                <td mat-cell *matCellDef="let rig" class="alCenter w10" > {{rig.machineSite}} </td>
            </ng-container>
            <ng-container matColumnDef="Engine Hrs" >
                <th mat-header-cell *matHeaderCellDef>Engine Hrs</th>
                <td mat-cell *matCellDef="let rig" class="alCenter w85" > {{rig.machineHrs}} </td>
            </ng-container>
            <ng-container matColumnDef="Service Int" >
                <th mat-header-cell *matHeaderCellDef class="alCenter">Next Service Int</th>
                <td mat-cell *matCellDef="let rig" class="alCenter w85"  > {{rig.serviceStep | thousands}} </td>
            </ng-container>
            <ng-container matColumnDef="Service Step" >
                <th mat-header-cell *matHeaderCellDef class="alCenter">Next Service Step</th>
                <td mat-cell *matCellDef="let rig" class="alCenter w85" > {{rig.serviceStepABC | thousands}} </td>
            </ng-container>
            <ng-container matColumnDef="Hours to next service" >
                <th mat-header-cell *matHeaderCellDef class="alCenter">Next service in</th>
                <td mat-cell *matCellDef="let rig"  class="alCenter w85"> 
                    {{rig.hoursLeftToService}}
                    
                </td>
            </ng-container>
            <ng-container matColumnDef="." >
                <th mat-header-cell *matHeaderCellDef class="alCenter"></th>
                <td mat-cell *matCellDef="let rig"  class="w2" > 
                    <div *ngIf="rig.hoursLeftToService>0" class="circ" [ngStyle]="{'background-color': rig.hoursLeftToService<=50? 'indianred' : rig.hoursLeftToService>50 && rig.hoursLeftToService<=100? 'gold':'lightgreen'}"></div> 
                </td>
            </ng-container>
            <ng-container matColumnDef="Service pred date" >
                <th mat-header-cell *matHeaderCellDef class="alCenter">Next Service Date</th>
                <td mat-cell *matCellDef="let rig"  class="alCenter w85" > {{rig.servicePredictedDate | dateconv}} </td>
            </ng-container>
            <ng-container matColumnDef="Prev day hours">
                <th mat-header-cell *matHeaderCellDef class="alCenter">Prev day hours</th>
                <td mat-cell *matCellDef="let rig"  class="alCenter w85" > {{rig.LastDayEngineHours}} </td>
            </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns" ></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </div>
    </div>
</div> 