<episjob-navbar title="New Visit" [cerca]="false" [backB]="'visit'"></episjob-navbar>

<div class="contG">
  <episjob-h2 icon="event_available" data="New Customer Visit"></episjob-h2>

<mat-vertical-stepper linear=true orientation="vertical" (selectionChange)="test($event)">
    
 <!-- <mat-step [stepControl]="custPotential">
    <ng-template matStepLabel>Potential</ng-template>
    <form [formGroup]="custPotential">
      <div class="potCont">
        <mat-form-field [appearance]="appearance" class="notesItem1">
          <mat-label>RDD</mat-label>
          <input matInput type="number" step="10" autocomplete="off" placeholder="Potential" formControlName="RDD" (input)="currency($event)">
          <mat-error>Choose a place from the list</mat-error>
        </mat-form-field>
        
      </div>
    </form>
    <div class="butt">
      <button mat-raised-button matStepperPrevious color="primary">Back</button>
      <button mat-raised-button matStepperNext color="primary" >Submit</button>
    </div>

  </mat-step>-->
  
  <!--DATE-->
  <mat-step [stepControl]="dateFormGroup">
      <ng-template matStepLabel>Select Date</ng-template>
      <form [formGroup]="dateFormGroup">
        <div class="cont dateCont">
          <mat-form-field [appearance]="appearance" class="dateItem1">
            <mat-label>Choose a date</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="date"> 
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
        </div>
        <div class="butt">
          <button mat-raised-button matStepperNext color="primary" *ngIf="!dateFormGroup.invalid">Next</button>
        </div>
      </form>
  </mat-step>
  <mat-step [stepControl]="custFormGroup">
      <ng-template matStepLabel>Customer</ng-template>
        <form [formGroup]="custFormGroup" class="custForm">
          <div class="custCont">
            <mat-form-field [appearance]="appearance" class="custItem1">
              <mat-label>Customer Name</mat-label>
              <input matInput type="text" placeholder="Customer Name" formControlName="c1" autocomplete="off" (keyup)="clearCust()">
            <mat-error>Choose a customer from the list or type a new name</mat-error>
            </mat-form-field>
            <mat-list class="list custItem4" *ngIf="chList() && listVis">
              <!--<div mat-subheader>Customers List</div>-->
              <mat-list-item *ngFor="let c of customers1" [ngStyle]="{'cursor':1==1? 'pointer':'arrow'}" (click)="addC(c.c1,c.c2,c.c3,c.id)">
                <mat-icon mat-list-icon>business</mat-icon>
                <div mat-line>{{c.c1}}</div>
                <div mat-line> {{c.c2}} | {{c.c3}} </div>
              </mat-list-item>
            </mat-list>
            <mat-form-field [appearance]="appearance" class="custItem2">
              <mat-label>Customer Address 1</mat-label>
              <input matInput type="text" placeholder="Customer Address 1" formControlName="c2"  autocomplete="off">
              <mat-error>Type Address Line 1</mat-error>
            </mat-form-field>
            <mat-form-field [appearance]="appearance"  class="custItem3">
              <mat-label>Customer Address 2</mat-label>
              <input matInput type="text" placeholder="Customer Address 2" formControlName="c3"  autocomplete="off">
              <mat-error>Type Address Line 2</mat-error>
            </mat-form-field>
          </div>

            
            <div class="butt">
                <button mat-raised-button matStepperPrevious color="primary">Back</button>
                <button mat-raised-button matStepperNext color="primary" *ngIf="!custFormGroup.invalid">Next</button>
            </div>
        </form>
  </mat-step>
  <mat-step [stepControl]="contactFormGroup">
    <ng-template matStepLabel>Contact</ng-template>
    <form [formGroup]="contactFormGroup">
    <div class="cont contCont">
      <mat-form-field [appearance]="appearance" class="contItem1">
        <mat-label>Name</mat-label>
        <input matInput type="text" autocomplete="off" placeholder="Name" formControlName="name" (keyup)="checkCont($event)"  autocomplete="off">
        <mat-error>Type Contact Name</mat-error>
      </mat-form-field>
      <mat-list class="list contItem5" *ngIf="listVisCont && contacts1.length>0">
        <!--<div mat-subheader>Existing Contacts for {{cuNa}}</div>-->
        <mat-list-item *ngFor="let c of contacts1" (click)="conCon(c.name, c.pos, c.phone, c.mail)" [ngStyle]="{'cursor':1==1? 'pointer':'arrow'}">
          <mat-icon mat-list-icon>person</mat-icon>
          <div mat-line>{{c.name}}</div>
          <div mat-line> {{c.pos}} | {{c.phone}} | {{c.mail}} </div>
        </mat-list-item>
      </mat-list>
      <mat-form-field [appearance]="appearance" class="contItem2">
        <mat-label>Position</mat-label>
        <input matInput type="text" autocomplete="off" placeholder="Position within the company" formControlName="pos">
        <mat-error>Type Contact Position</mat-error>
      </mat-form-field>
      <mat-form-field [appearance]="appearance" class="contItem3">
        <mat-label>Phone</mat-label>
        <input matInput type="text" autocomplete="off" placeholder="Phone nr." formControlName="phone">
        <mat-error>Type Contact Phone Nr</mat-error>
      </mat-form-field>
      <mat-form-field [appearance]="appearance" class="contItem4">
        <mat-label>Mail</mat-label>
        <input matInput type="email" autocomplete="off" placeholder="Email address" formControlName="mail">
        <mat-error>Type a valid Mail address</mat-error>
      </mat-form-field>
    </div>
  </form>
  <div class="butt">
    <button mat-raised-button matStepperPrevious color="primary">Back</button>
    <button mat-raised-button matStepperNext color="primary" *ngIf="!contactFormGroup.invalid">Next</button>
  </div>
  </mat-step>
  <mat-step [stepControl]="visitNotes">
    <ng-template matStepLabel>Notes</ng-template>
    <form [formGroup]="visitNotes">
      <div class="notesCont">
        <mat-form-field [appearance]="appearance" class="notesItem1">
          <mat-label>Place</mat-label>
          <input matInput type="text" autocomplete="off" placeholder="Place" formControlName="place" (keyup)="checkPlace($event)">
          <mat-error>Choose a place from the list</mat-error>
        </mat-form-field>
        <mat-list class="list notesItem2" *ngIf="lisComVis">
          <!--<div mat-subheader>Existing Contacts for {{cuNa}}</div>-->
          <mat-list-item *ngFor="let c of comuni" [ngStyle]="{'cursor':1==1? 'pointer':'arrow'}" (click)="conPlace(c)">
            <mat-icon mat-list-icon>location_on</mat-icon>
            <div mat-line>{{c}}</div>
          </mat-list-item>
        </mat-list>
        <mat-form-field [appearance]="appearance" class="notesItem3">
          <textarea placeholder="Type notes here..." matInput formControlName="notes" rows="15"></textarea>
        </mat-form-field>
      </div>
    </form>
    <div class="butt">
      <button mat-raised-button matStepperPrevious color="primary">Back</button>
      <button mat-raised-button matStepperNext color="primary" *ngIf="!visitNotes.invalid">Next</button>
    </div>

  </mat-step>

  <!--POTENTIAL-->
  <mat-step [stepControl]="potential">
    <ng-template matStepLabel>Potential</ng-template>
    <episjob-potential [custId]="cId[0]?cId[0].id:''"></episjob-potential>
    <div class="butt">
      <button mat-raised-button matStepperPrevious color="primary">Back</button>
      <button mat-raised-button matStepperNext color="primary" (click)=submit()>Submit</button>
    </div>
  </mat-step>
</mat-vertical-stepper>
</div>